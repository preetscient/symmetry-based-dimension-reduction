
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../viz/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.35">
    
    
      
        <title>Batch processing - Symmetry-Based Dimension Reduction</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dsdp-lumping.__batch_run__" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Symmetry-Based Dimension Reduction" class="md-header__button md-logo" aria-label="Symmetry-Based Dimension Reduction" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Symmetry-Based Dimension Reduction
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Batch processing
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/preetscient/symmetry-based-dimension-reduction" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Symmetry-Based Dimension Reduction" class="md-nav__button md-logo" aria-label="Symmetry-Based Dimension Reduction" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Symmetry-Based Dimension Reduction
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/preetscient/symmetry-based-dimension-reduction" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow of data
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processing script
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../auts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Finding automorphisms
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gaut2gap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preparing data for GAP
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lumping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dimension reduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../viz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dashboard and Visualisation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Batch processing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Batch processing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__" class="md-nav__link">
    <span class="md-ellipsis">
      __batch_run__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.compute_file_hash" class="md-nav__link">
    <span class="md-ellipsis">
      compute_file_hash
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.has_data_changed" class="md-nav__link">
    <span class="md-ellipsis">
      has_data_changed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.store_data_hashes" class="md-nav__link">
    <span class="md-ellipsis">
      store_data_hashes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__" class="md-nav__link">
    <span class="md-ellipsis">
      __batch_run__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.compute_file_hash" class="md-nav__link">
    <span class="md-ellipsis">
      compute_file_hash
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.has_data_changed" class="md-nav__link">
    <span class="md-ellipsis">
      has_data_changed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dsdp-lumping.__batch_run__.store_data_hashes" class="md-nav__link">
    <span class="md-ellipsis">
      store_data_hashes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Batch processing</h1>

<p><img alt="Diagram to illustrate the batch processing process" src="../batch_processing.png" /></p>
<p>Dashboard users can toggle between 'User Uploaded Data' and 'Pre-loaded Data'. </p>
<p>The 'Pre-loaded data' consists of processed network data that users can toggle between to demonstrate the operation of the dashboard. The processed data originates from network data associated with the paper “<a href="http://doi.org/10.1098/rspa.2021.0026">Dimension-reduction of dynamics on real-world networks with symmetry</a>.</p>
<p>This data is generated through running <strong>batch_processing</strong>.py, you can do this by running</p>
<p><code>python -m dsdp-lumping batch</code></p>


<div class="doc doc-object doc-module">



<a id="dsdp-lumping.__batch_run__"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dsdp-lumping.__batch_run__.compute_file_hash" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_file_hash</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the MD5 hash of the specified file.</p>
<p>Parameters:
filepath (str): The path to the file for which the MD5 hash will be calculated.</p>
<p>Returns:
str: The MD5 hash of the file as a hexadecimal string.</p>

            <details class="quote">
              <summary>Source code in <code>dsdp-lumping/__batch_run__.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_file_hash</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the MD5 hash of the specified file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    filepath (str): The path to the file for which the MD5 hash will be calculated.</span>

<span class="sd">    Returns:</span>
<span class="sd">    str: The MD5 hash of the file as a hexadecimal string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hash_md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span> <span class="c1"># Create a new MD5 hash object</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1"># Open the file in binary mode</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4096</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">):</span> <span class="c1"># Read file in chunks of 4096 bytes</span>
            <span class="n">hash_md5</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="c1"># Update the hash with each chunk</span>
    <span class="k">return</span> <span class="n">hash_md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="c1"># Return the computed hash as a hex string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dsdp-lumping.__batch_run__.has_data_changed" class="doc doc-heading">
            <code class=" language-python"><span class="n">has_data_changed</span><span class="p">(</span><span class="n">DATA_FILES</span><span class="p">,</span> <span class="n">HASH_FILES</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Checks if any data files have changed by comparing stored hashes with current hashes.</p>
<p>Parameters:
DATA_FILES (list): A list of paths to the data files to be checked.
HASH_FILES (dict): A dictionary mapping each data file path to its corresponding hash file path.</p>
<p>Returns:
bool: True if any data file has changed or if any hash file is missing; otherwise, False.</p>

            <details class="quote">
              <summary>Source code in <code>dsdp-lumping/__batch_run__.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_data_changed</span><span class="p">(</span><span class="n">DATA_FILES</span><span class="p">,</span><span class="n">HASH_FILES</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if any data files have changed by comparing stored hashes with current hashes.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    DATA_FILES (list): A list of paths to the data files to be checked.</span>
<span class="sd">    HASH_FILES (dict): A dictionary mapping each data file path to its corresponding hash file path.</span>

<span class="sd">    Returns:</span>
<span class="sd">    bool: True if any data file has changed or if any hash file is missing; otherwise, False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">data_file</span> <span class="ow">in</span> <span class="n">DATA_FILES</span><span class="p">:</span> <span class="c1"># Iterate through each data file</span>
        <span class="n">hash_file</span> <span class="o">=</span> <span class="n">HASH_FILES</span><span class="p">[</span><span class="n">data_file</span><span class="p">]</span> <span class="c1"># Get corresponding hash file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">hash_file</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># No hash file means data has not been processed</span>

        <span class="c1"># Compute the current hash of the data file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">hash_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">stored_hash</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">current_hash</span> <span class="o">=</span> <span class="n">compute_file_hash</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_hash</span> <span class="o">!=</span> <span class="n">stored_hash</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span> <span class="c1"># If the current hash doesn&#39;t match the stored hash, the data has changed</span>

    <span class="k">return</span> <span class="kc">False</span> <span class="c1"># If all hashes match, data has not changed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dsdp-lumping.__batch_run__.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Main function to process network data files.</p>
<p>This function performs the following steps:
1. Sets up paths and identifies data files to process.
2. Checks if any data files have changed by comparing file hashes.
3. If no changes are detected, processing is skipped.
4. If changes are detected:
   - Runs various processing scripts (<code>batch_auts</code>, <code>batch_gaut2gap</code>, <code>batch_lumping</code>).
   - Updates visualizations with <code>vizprocessing</code>.
   - Stores new file hashes to track processed data.</p>
<p>Returns:
None</p>

            <details class="quote">
              <summary>Source code in <code>dsdp-lumping/__batch_run__.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to process network data files.</span>

<span class="sd">    This function performs the following steps:</span>
<span class="sd">    1. Sets up paths and identifies data files to process.</span>
<span class="sd">    2. Checks if any data files have changed by comparing file hashes.</span>
<span class="sd">    3. If no changes are detected, processing is skipped.</span>
<span class="sd">    4. If changes are detected:</span>
<span class="sd">       - Runs various processing scripts (`batch_auts`, `batch_gaut2gap`, `batch_lumping`).</span>
<span class="sd">       - Updates visualizations with `vizprocessing`.</span>
<span class="sd">       - Stores new file hashes to track processed data.</span>

<span class="sd">    Returns:</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_file_path</span>   <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
    <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_file_path</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
    <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span>

    <span class="c1"># Define the path to the .scy files</span>
    <span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;external&#39;</span><span class="p">,</span><span class="s1">&#39;1_network_data&#39;</span><span class="p">,</span><span class="s1">&#39;networkrepository&#39;</span><span class="p">,</span><span class="s1">&#39;*.scy&#39;</span><span class="p">)</span>

    <span class="c1"># Get a list of all data files matching the pattern in the data path</span>
    <span class="n">DATA_FILES</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

    <span class="c1"># Create a dictionary mapping each data file to its corresponding hash file</span>
    <span class="n">HASH_FILES</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">_hash.txt&quot;</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">DATA_FILES</span><span class="p">}</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_data_changed</span><span class="p">(</span><span class="n">DATA_FILES</span><span class="p">,</span><span class="n">HASH_FILES</span><span class="p">):</span> <span class="c1"># Check if any data files have changed</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing has already been completed for all data files.&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running saucy&quot;</span><span class="p">)</span>
        <span class="n">batch_auts</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running gaut2gap...&quot;</span><span class="p">)</span>
        <span class="n">batch_gaut2gap</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running lumping...&quot;</span><span class="p">)</span>
        <span class="n">batch_lumping</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing pre-loaded networks...&quot;</span><span class="p">)</span>
        <span class="n">vizprocessing</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>

        <span class="c1">#Store the new hashes after successful processing</span>
        <span class="n">store_data_hashes</span><span class="p">(</span><span class="n">DATA_FILES</span><span class="p">,</span><span class="n">HASH_FILES</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing complete. Data hashes updated.&quot;</span><span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dsdp-lumping.__batch_run__.store_data_hashes" class="doc doc-heading">
            <code class=" language-python"><span class="n">store_data_hashes</span><span class="p">(</span><span class="n">DATA_FILES</span><span class="p">,</span> <span class="n">HASH_FILES</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Stores the current hashes of the data files in their corresponding hash files.</p>
<p>Parameters:
DATA_FILES (list): A list of paths to the data files.
HASH_FILES (dict): A dictionary mapping each data file path to its corresponding hash file path.</p>
<p>Returns:
None</p>

            <details class="quote">
              <summary>Source code in <code>dsdp-lumping/__batch_run__.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">store_data_hashes</span><span class="p">(</span><span class="n">DATA_FILES</span><span class="p">,</span><span class="n">HASH_FILES</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stores the current hashes of the data files in their corresponding hash files.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    DATA_FILES (list): A list of paths to the data files.</span>
<span class="sd">    HASH_FILES (dict): A dictionary mapping each data file path to its corresponding hash file path.</span>

<span class="sd">    Returns:</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">data_file</span> <span class="ow">in</span> <span class="n">DATA_FILES</span><span class="p">:</span>
        <span class="n">current_hash</span> <span class="o">=</span> <span class="n">compute_file_hash</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">HASH_FILES</span><span class="p">[</span><span class="n">data_file</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">current_hash</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>